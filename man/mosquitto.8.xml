<?xml version='1.0' encoding='ISO-8859-1'?>
<?xml-stylesheet type="text/xsl" href="http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "/usr/share/sgml/docbook/xml-dtd-4.4/docbookx.dtd">

<refentry xml:id="mosquitto">
	<refmeta>
		<refentrytitle>mosquitto</refentrytitle>
		<manvolnum>8</manvolnum>
	</refmeta>

	<refnamediv>
		<refname>mosquitto</refname>
		<refpurpose>an mqtt broker</refpurpose>
	</refnamediv>

	<refsynopsisdiv>
		<cmdsynopsis>
			<command>mosquitto</command>
			<group choice='opt'>
				<arg><option>-c</option> <replaceable>config file</replaceable></arg>
			</group>
			<group choice='opt'>
				<arg><option>-d</option></arg>
				<arg><option>--daemon</option></arg>
			</group>
			<group choice='opt'>
				<arg><option>-p</option> <replaceable>port number</replaceable></arg>
			</group>
		</cmdsynopsis>
	</refsynopsisdiv>

	<refsect1>
		<title>Description</title>
		<para><command>mosquitto</command> is a broker for the mqtt protocol version 3.</para>
		<para>It is intended to be a drop in replacement for rsmb, but it's a long way off yet.</para>
	</refsect1>

	<refsect1>
		<title>Options</title>
		<variablelist>
			<varlistentry>
				<term><option>-c</option></term>
				<term><option>--config-file</option></term>
				<listitem>
					<para>Load configuration from a file. In not given, the default values as described in <citerefentry><refentrytitle>mosquitto.conf</refentrytitle><manvolnum>5</manvolnum></citerefentry> are used.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>-d</option></term>
				<term><option>--daemon</option></term>
				<listitem>
					<para>Run <command>mosquitto</command> in the background as a daemon. All other behaviour remains the same.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>-p</option></term>
				<term><option>--port</option></term>
				<listitem>
					<para>Listen on the port specified instead of the default 1883. This overrides the port setting in the config file.</para>
				</listitem>
			</varlistentry>
		</variablelist>
	</refsect1>

	<refsect1>
		<title>Limitations</title>
		<para><command>mosquitto</command> implements all of the mqtt protocol version 3, but there are some significant limitations compared to rsmb.</para>
		<itemizedlist mark="circle">
			<listitem><para>There is no bridge support.</para></listitem>
			<listitem><para>Wildcards within subscription requests are not supported.</para></listitem>
			<listitem><para>There are vastly fewer configuration options.</para></listitem>
			<listitem><para>Only binding to a single port is possible, and it's not possible to bind to a specific address.</para></listitem>
			<listitem><para>There is no logging information.</para></listitem>
			<listitem><para>The $SYS hierarchy is smaller.</para></listitem>
			<listitem><para>It isn't as well tested or documented...</para></listitem>
		</itemizedlist>
		<para>It should be noted that all of the above limitations should have &quot;currently&quot; included in them. They will all be fixed at some point.</para>
	</refsect1>

	<refsect1>
		<title>Broker Status</title>
		<para>Clients can find information about the broker by subscribing to topics in the $SYS hierarchy as follows. Topics marked as static are only sent once per client on subscription. Topics marked dynamic are updated every <option>sys_interval</option> seconds.</para>
		<variablelist>
			<varlistentry>
				<term><option>$SYS/broker/heap/current size</option></term>
				<listitem>
					<para>The current size of the heap memory in use by mosquitto. Dynamic.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>$SYS/broker/version</option></term>
				<listitem>
					<para>The version of the broker. Static.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>$SYS/broker/uptime</option></term>
				<listitem>
					<para>The amount of time in seconds the broker has been online. Dynamic.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>$SYS/messages/inflight</option></term>
				<listitem>
					<para>The number of messages currently in flight. Dynamic.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>$SYS/messages/sent</option></term>
				<listitem>
					<para>The total number of messages sent since the broker started. Dynamic. (not yet implemented)</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><option>$SYS/messages/received</option></term>
				<listitem>
					<para>The total number of messages received since the broker started. Dynamic. (not yet implemented)</para>
				</listitem>
			</varlistentry>
		</variablelist>
	</refsect1>

	<refsect1>
		<title>Files</title>
		<variablelist>
			<varlistentry>
				<term><filename>/etc/mosquitto.conf</filename></term>
				<listitem>
					<para>Configuration file. See <citerefentry><refentrytitle>mosquitto.conf</refentrytitle><manvolnum>5</manvolnum></citerefentry>.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><filename>/var/lib/mosquitto/mosquitto.db</filename></term>
				<listitem>
					<para>Persistent message data storage location if persist enabled.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><filename>/etc/hosts.allow</filename></term>
				<term><filename>/etc/hosts.deny</filename></term>
				<listitem>
					<para>Host access control via tcp-wrappers as described in <citerefentry><refentrytitle>hosts_access</refentrytitle><manvolnum>5</manvolnum></citerefentry>.</para>
				</listitem>
			</varlistentry>
		</variablelist>
	</refsect1>

	<refsect1>
		<title>Bugs</title>
		<para><command>mosquitto</command> bug information can be found at <uri type="webpage">http://launchpad.net/mosquitto</uri>.</para>
	</refsect1>

	<refsect1>
		<title>See Also</title>
		<para>
			<citerefentry>
				<refentrytitle>mosquitto.conf</refentrytitle>
				<manvolnum>5</manvolnum>
			</citerefentry>
			<citerefentry>
				<refentrytitle>hosts_access</refentrytitle>
				<manvolnum>5</manvolnum>
			</citerefentry>
		</para>
	</refsect1>

	<refsect1>
		<title>Thanks</title>
		<para>Thanks to Andy Stanford-Clark for being one of the people who came up with MQTT in the first place and providing clarifications of the protocol.</para>
		<para>Thanks also to everybody at the Ubuntu UK Podcast and Linux Outlaws for organising OggCamp, where Andy gave a talk that inspired mosquitto.</para>
	</refsect1>

	<refsect1>
		<title>Author</title>
		<para>Roger Light <email>roger@atchoo.org</email></para>
	</refsect1>
</refentry>
